---
layout: post
title: 동적할당과 배열(작성중)
date: 2025-11-08 14:01:00 +0900
category: C
---
- 동적할당을 사용하는 이유
------------------------
   1. **메모리내 스택이 아닌 힙에 저장됨**
   2. **런타임중 크기를 결정할 때**
   3. **큰 배열로 인한 스택초과 방지**   

- 배열을 동적할당하는 이유
-------------------------
   - **런타임중 크기를 결정할때**   
      임의의 값을 입력받아서 배열의 크기를 정해야하는 경우에, 입력받은 크기만큼 효율적으로 메모리를 사용할 수 있음   

   - **문자열을 담는경우에는 널 종료문자까지 n+1 바이트가 필요하다**
      문자를 입력받는 경우(scanf, fgets)에는 입력받은 문자+널문자('\0')로 1바이트 추가저장되기때문 

   ```C
      int n;//배열의 크기
      int *p;

      scanf("%d", &n);
      p=(int *)malloc(sizeof(int)*n);

      free(p);
   ```
   ```C
      char tmp[100];
      char *p;

      scanf("%s", tmp);
      p=malloc(sizeof(char )*(strlen(tmp)+1));

      free(p);
   ```
   
- 이중포인터와 동적할당
---------------------
   1. **행의 개수만큼 할당하기**   
      힙에 포인터 테이블(포인터들의 배열) 할당하기(청크 1개)
   2. **각 행의 배열의 크기만큼 할당하기**   
      각 행의 크기만큼 청크 할당(청크 행의 개수)
   3. **청크의 개수 : 행의개수+1**
      
   ```C
   int row, col;

   scanf("%d", &row);

   char **p=(char **)malloc(sizeof(char *)*row);

   for(int i=0; i<row; i++){
      scanf("%d", &col);
      p[i]=(char *)malloc(sizeof(char)*(col+1))
   }
   
   for(int i=0; i<row; i++){
      free(p[i]);
   }

   free(p);

   ```

   